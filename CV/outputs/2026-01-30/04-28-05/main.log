[2026-01-30 04:28:07,412][cifar10_resnet50_True][INFO] - --- Experiment: cifar10 + resnet50 ---
[2026-01-30 04:28:07,415][cifar10_resnet50_True][INFO] - Config:
model:
  name: resnet50
  num_classes: 10
  pretrained: true
  image_size: 32
train:
  epochs: 50
  batch_size: 64
  learning_rate: 0.1
  weight_decay: 0.0005
  optimizer: sgd
  momentum: 0.9
  device: cuda
  log_dir: ./logs
dataset:
  name: cifar10
  path: /workspace/cv/data/cifar10
  num_classes: 10
  image_size: 32
data:
  batch_size: 64
  num_workers: 4
seed: 42
output_dir: ./outputs
eval:
  batch_size: 256
  device: cuda
robustness:
  data_root: ./data/CIFAR-10-C
  batch_size: 256
  device: cuda
background:
  data_root: ./data/ImageNet9
  epochs: 5
  batch_size: 64
  learning_rate: 0.0001
  device: cuda

[2026-01-30 04:28:09,006][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/resnet50.a1_in1k)
[2026-01-30 04:28:09,249][httpx][INFO] - HTTP Request: HEAD https://huggingface.co/timm/resnet50.a1_in1k/resolve/main/model.safetensors "HTTP/1.1 302 Found"
[2026-01-30 04:28:09,254][timm.models._hub][INFO] - [timm/resnet50.a1_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2026-01-30 04:28:09,307][timm.models._builder][INFO] - Missing keys (fc.weight, fc.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
[2026-01-30 04:28:09,451][cifar10_resnet50_True][INFO] - Optimizer: SGD (lr=0.1, momentum=0.9)
[2026-01-30 04:28:39,916][cifar10_resnet50_True][INFO] - Epoch 1/50 | Train Loss: 1.7431 | Train Top1: 35.97% | Val Top1: 40.34% | Val Top5: 89.02%
[2026-01-30 04:28:40,739][cifar10_resnet50_True][INFO] -    >>> Best model saved (Top1: 40.34%)
[2026-01-30 04:29:11,072][cifar10_resnet50_True][INFO] - Epoch 2/50 | Train Loss: 1.3476 | Train Top1: 51.94% | Val Top1: 55.62% | Val Top5: 93.72%
[2026-01-30 04:29:11,893][cifar10_resnet50_True][INFO] -    >>> Best model saved (Top1: 55.62%)
[2026-01-30 04:29:42,250][cifar10_resnet50_True][INFO] - Epoch 3/50 | Train Loss: 1.0872 | Train Top1: 62.13% | Val Top1: 59.14% | Val Top5: 95.44%
[2026-01-30 04:29:43,051][cifar10_resnet50_True][INFO] -    >>> Best model saved (Top1: 59.14%)
[2026-01-30 04:30:13,616][cifar10_resnet50_True][INFO] - Epoch 4/50 | Train Loss: 0.9304 | Train Top1: 68.14% | Val Top1: 67.08% | Val Top5: 96.80%
[2026-01-30 04:30:14,451][cifar10_resnet50_True][INFO] -    >>> Best model saved (Top1: 67.08%)
[2026-01-30 04:30:46,039][cifar10_resnet50_True][INFO] - Epoch 5/50 | Train Loss: 0.8755 | Train Top1: 70.19% | Val Top1: 62.78% | Val Top5: 95.90%
[2026-01-30 04:31:17,476][cifar10_resnet50_True][INFO] - Epoch 6/50 | Train Loss: 0.8581 | Train Top1: 70.89% | Val Top1: 64.42% | Val Top5: 96.06%
[2026-01-30 04:31:49,083][cifar10_resnet50_True][INFO] - Epoch 7/50 | Train Loss: 0.8360 | Train Top1: 71.58% | Val Top1: 67.38% | Val Top5: 97.18%
[2026-01-30 04:31:49,899][cifar10_resnet50_True][INFO] -    >>> Best model saved (Top1: 67.38%)
[2026-01-30 04:32:21,814][cifar10_resnet50_True][INFO] - Epoch 8/50 | Train Loss: 0.8291 | Train Top1: 71.96% | Val Top1: 64.24% | Val Top5: 96.18%
[2026-01-30 04:32:53,513][cifar10_resnet50_True][INFO] - Epoch 9/50 | Train Loss: 0.8241 | Train Top1: 72.24% | Val Top1: 65.64% | Val Top5: 96.28%
[2026-01-30 04:33:25,224][cifar10_resnet50_True][INFO] - Epoch 10/50 | Train Loss: 0.8164 | Train Top1: 72.24% | Val Top1: 64.24% | Val Top5: 96.50%
[2026-01-30 04:33:56,978][cifar10_resnet50_True][INFO] - Epoch 11/50 | Train Loss: 0.8022 | Train Top1: 72.92% | Val Top1: 67.84% | Val Top5: 97.18%
[2026-01-30 04:33:57,758][cifar10_resnet50_True][INFO] -    >>> Best model saved (Top1: 67.84%)
[2026-01-30 04:34:29,615][cifar10_resnet50_True][INFO] - Epoch 12/50 | Train Loss: 0.7981 | Train Top1: 72.84% | Val Top1: 68.70% | Val Top5: 97.52%
[2026-01-30 04:34:30,440][cifar10_resnet50_True][INFO] -    >>> Best model saved (Top1: 68.70%)
[2026-01-30 04:35:02,582][cifar10_resnet50_True][INFO] - Epoch 13/50 | Train Loss: 0.7825 | Train Top1: 73.64% | Val Top1: 67.58% | Val Top5: 97.02%
[2026-01-30 04:35:34,400][cifar10_resnet50_True][INFO] - Epoch 14/50 | Train Loss: 0.7793 | Train Top1: 73.75% | Val Top1: 67.86% | Val Top5: 96.50%
[2026-01-30 04:36:06,363][cifar10_resnet50_True][INFO] - Epoch 15/50 | Train Loss: 0.7812 | Train Top1: 73.56% | Val Top1: 68.20% | Val Top5: 96.78%
[2026-01-30 04:36:38,200][cifar10_resnet50_True][INFO] - Epoch 16/50 | Train Loss: 0.7673 | Train Top1: 74.29% | Val Top1: 66.38% | Val Top5: 96.68%
[2026-01-30 04:37:10,146][cifar10_resnet50_True][INFO] - Epoch 17/50 | Train Loss: 0.7613 | Train Top1: 74.31% | Val Top1: 70.70% | Val Top5: 96.86%
[2026-01-30 04:37:10,985][cifar10_resnet50_True][INFO] -    >>> Best model saved (Top1: 70.70%)
[2026-01-30 04:37:42,815][cifar10_resnet50_True][INFO] - Epoch 18/50 | Train Loss: 0.7481 | Train Top1: 74.91% | Val Top1: 69.74% | Val Top5: 97.22%
[2026-01-30 04:38:14,620][cifar10_resnet50_True][INFO] - Epoch 19/50 | Train Loss: 0.7512 | Train Top1: 74.54% | Val Top1: 68.44% | Val Top5: 96.44%
[2026-01-30 04:38:46,521][cifar10_resnet50_True][INFO] - Epoch 20/50 | Train Loss: 0.7459 | Train Top1: 75.03% | Val Top1: 70.72% | Val Top5: 97.24%
[2026-01-30 04:38:47,336][cifar10_resnet50_True][INFO] -    >>> Best model saved (Top1: 70.72%)
[2026-01-30 04:39:19,277][cifar10_resnet50_True][INFO] - Epoch 21/50 | Train Loss: 0.7357 | Train Top1: 75.19% | Val Top1: 68.64% | Val Top5: 96.74%
[2026-01-30 04:39:51,072][cifar10_resnet50_True][INFO] - Epoch 22/50 | Train Loss: 0.7316 | Train Top1: 75.31% | Val Top1: 69.98% | Val Top5: 96.58%
[2026-01-30 04:40:22,979][cifar10_resnet50_True][INFO] - Epoch 23/50 | Train Loss: 0.7359 | Train Top1: 75.23% | Val Top1: 67.98% | Val Top5: 96.10%
[2026-01-30 04:40:54,674][cifar10_resnet50_True][INFO] - Epoch 24/50 | Train Loss: 0.7362 | Train Top1: 75.34% | Val Top1: 68.72% | Val Top5: 97.30%
[2026-01-30 04:41:26,478][cifar10_resnet50_True][INFO] - Epoch 25/50 | Train Loss: 0.7322 | Train Top1: 75.26% | Val Top1: 69.32% | Val Top5: 97.28%
[2026-01-30 04:41:58,441][cifar10_resnet50_True][INFO] - Epoch 26/50 | Train Loss: 0.7250 | Train Top1: 75.57% | Val Top1: 68.66% | Val Top5: 96.26%
[2026-01-30 04:42:30,823][cifar10_resnet50_True][INFO] - Epoch 27/50 | Train Loss: 0.7332 | Train Top1: 75.13% | Val Top1: 72.78% | Val Top5: 97.60%
[2026-01-30 04:42:31,674][cifar10_resnet50_True][INFO] -    >>> Best model saved (Top1: 72.78%)
[2026-01-30 04:43:03,998][cifar10_resnet50_True][INFO] - Epoch 28/50 | Train Loss: 0.7216 | Train Top1: 75.82% | Val Top1: 69.14% | Val Top5: 97.52%
[2026-01-30 04:43:36,184][cifar10_resnet50_True][INFO] - Epoch 29/50 | Train Loss: 0.7147 | Train Top1: 76.00% | Val Top1: 67.54% | Val Top5: 97.28%
[2026-01-30 04:44:08,449][cifar10_resnet50_True][INFO] - Epoch 30/50 | Train Loss: 0.7303 | Train Top1: 75.52% | Val Top1: 64.86% | Val Top5: 96.32%
[2026-01-30 04:44:40,944][cifar10_resnet50_True][INFO] - Epoch 31/50 | Train Loss: 0.7145 | Train Top1: 75.78% | Val Top1: 67.50% | Val Top5: 96.82%
[2026-01-30 04:45:13,118][cifar10_resnet50_True][INFO] - Epoch 32/50 | Train Loss: 0.7201 | Train Top1: 75.56% | Val Top1: 58.12% | Val Top5: 94.68%
[2026-01-30 04:45:45,037][cifar10_resnet50_True][INFO] - Epoch 33/50 | Train Loss: 0.7203 | Train Top1: 75.77% | Val Top1: 69.88% | Val Top5: 96.72%
[2026-01-30 04:46:16,820][cifar10_resnet50_True][INFO] - Epoch 34/50 | Train Loss: 0.7169 | Train Top1: 75.82% | Val Top1: 68.22% | Val Top5: 96.58%
[2026-01-30 04:46:48,783][cifar10_resnet50_True][INFO] - Epoch 35/50 | Train Loss: 0.7098 | Train Top1: 76.22% | Val Top1: 65.50% | Val Top5: 96.78%
[2026-01-30 04:47:20,768][cifar10_resnet50_True][INFO] - Epoch 36/50 | Train Loss: 0.7255 | Train Top1: 75.50% | Val Top1: 66.32% | Val Top5: 96.70%
[2026-01-30 04:47:52,867][cifar10_resnet50_True][INFO] - Epoch 37/50 | Train Loss: 0.7185 | Train Top1: 75.85% | Val Top1: 66.86% | Val Top5: 96.22%
[2026-01-30 04:48:25,136][cifar10_resnet50_True][INFO] - Epoch 38/50 | Train Loss: 0.7081 | Train Top1: 75.99% | Val Top1: 67.30% | Val Top5: 97.00%
[2026-01-30 04:48:57,215][cifar10_resnet50_True][INFO] - Epoch 39/50 | Train Loss: 0.7095 | Train Top1: 76.33% | Val Top1: 68.14% | Val Top5: 96.72%
[2026-01-30 04:49:29,583][cifar10_resnet50_True][INFO] - Epoch 40/50 | Train Loss: 0.7078 | Train Top1: 76.09% | Val Top1: 72.80% | Val Top5: 97.28%
[2026-01-30 04:49:30,176][cifar10_resnet50_True][INFO] -    >>> Best model saved (Top1: 72.80%)
[2026-01-30 04:50:02,213][cifar10_resnet50_True][INFO] - Epoch 41/50 | Train Loss: 0.7111 | Train Top1: 76.17% | Val Top1: 71.82% | Val Top5: 97.66%
[2026-01-30 04:50:37,400][cifar10_resnet50_True][INFO] - Epoch 42/50 | Train Loss: 0.7037 | Train Top1: 76.34% | Val Top1: 67.02% | Val Top5: 96.72%
[2026-01-30 04:51:11,435][cifar10_resnet50_True][INFO] - Epoch 43/50 | Train Loss: 0.7017 | Train Top1: 76.32% | Val Top1: 62.82% | Val Top5: 96.64%
[2026-01-30 04:51:43,067][cifar10_resnet50_True][INFO] - Epoch 44/50 | Train Loss: 0.7096 | Train Top1: 76.20% | Val Top1: 59.32% | Val Top5: 93.14%
[2026-01-30 04:52:14,811][cifar10_resnet50_True][INFO] - Epoch 45/50 | Train Loss: 0.7286 | Train Top1: 75.33% | Val Top1: 71.62% | Val Top5: 97.04%
[2026-01-30 04:52:46,478][cifar10_resnet50_True][INFO] - Epoch 46/50 | Train Loss: 0.7010 | Train Top1: 76.29% | Val Top1: 72.06% | Val Top5: 97.44%
[2026-01-30 04:53:18,096][cifar10_resnet50_True][INFO] - Epoch 47/50 | Train Loss: 0.6928 | Train Top1: 76.64% | Val Top1: 64.50% | Val Top5: 96.32%
[2026-01-30 04:53:49,934][cifar10_resnet50_True][INFO] - Epoch 48/50 | Train Loss: 0.7029 | Train Top1: 76.28% | Val Top1: 68.52% | Val Top5: 96.52%
[2026-01-30 04:54:21,667][cifar10_resnet50_True][INFO] - Epoch 49/50 | Train Loss: 0.7031 | Train Top1: 75.92% | Val Top1: 67.68% | Val Top5: 96.40%
[2026-01-30 04:54:53,191][cifar10_resnet50_True][INFO] - Epoch 50/50 | Train Loss: 0.7125 | Train Top1: 76.03% | Val Top1: 71.82% | Val Top5: 97.76%
[2026-01-30 04:54:53,192][cifar10_resnet50_True][INFO] - --- Training Finished. Running Final Evaluation with Best Model ---
[2026-01-30 04:54:55,066][cifar10_resnet50_True][INFO] - Final Result -> Loss: 0.8201 | Top-1: 72.43% | Top-5: 97.31%
