[2026-01-30 11:49:14,738][cifar10_vit_small_pretrained][INFO] - --- Experiment: cifar10 + vit_small_patch16_224 ---
[2026-01-30 11:49:14,740][cifar10_vit_small_pretrained][INFO] - Config:
model:
  name: vit_small_patch16_224
  num_classes: 10
  pretrained: true
  image_size: 224
  cfg_name: vit_small_pretrained
train:
  epochs: 50
  batch_size: 64
  learning_rate: 0.1
  weight_decay: 0.0005
  optimizer: sgd
  device: cuda
  momentum: 0.9
  log_dir: ./logs
dataset:
  name: cifar10
  path: /workspace/cv/data/cifar10
  num_classes: 10
  image_size: 32
data:
  batch_size: 64
  num_workers: 4
seed: 42
output_dir: ./outputs
eval:
  batch_size: 256
  device: cuda
robustness:
  data_root: ./data/CIFAR-10-C
  batch_size: 256
  device: cuda
background:
  data_root: ./data/ImageNet9
  epochs: 5
  batch_size: 64
  learning_rate: 0.0001
  device: cuda

[2026-01-30 11:49:16,312][timm.models._builder][INFO] - Loading pretrained weights from Hugging Face hub (timm/vit_small_patch16_224.augreg_in21k_ft_in1k)
[2026-01-30 11:49:16,575][httpx][INFO] - HTTP Request: HEAD https://huggingface.co/timm/vit_small_patch16_224.augreg_in21k_ft_in1k/resolve/main/model.safetensors "HTTP/1.1 302 Found"
[2026-01-30 11:49:16,576][timm.models._hub][INFO] - [timm/vit_small_patch16_224.augreg_in21k_ft_in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
[2026-01-30 11:49:16,594][timm.models._builder][INFO] - Missing keys (head.weight, head.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
[2026-01-30 11:49:16,751][cifar10_vit_small_pretrained][INFO] - Optimizer: SGD (lr=0.1, momentum=0.9)
[2026-01-30 11:54:59,356][cifar10_vit_small_pretrained][INFO] - Epoch 1/50 | Train Loss: 77.5498 | Train Top1: 9.93% | Val Top1: 9.64% | Val Top5: 49.68%
[2026-01-30 11:54:59,461][cifar10_vit_small_pretrained][INFO] -    >>> Best model saved (Top1: 9.64%)
[2026-01-30 12:00:42,258][cifar10_vit_small_pretrained][INFO] - Epoch 2/50 | Train Loss: 2.3222 | Train Top1: 10.05% | Val Top1: 10.04% | Val Top5: 50.56%
[2026-01-30 12:00:42,849][cifar10_vit_small_pretrained][INFO] -    >>> Best model saved (Top1: 10.04%)
[2026-01-30 12:06:25,674][cifar10_vit_small_pretrained][INFO] - Epoch 3/50 | Train Loss: 2.3091 | Train Top1: 10.06% | Val Top1: 10.04% | Val Top5: 50.36%
[2026-01-30 12:12:07,792][cifar10_vit_small_pretrained][INFO] - Epoch 4/50 | Train Loss: 2.3065 | Train Top1: 9.98% | Val Top1: 10.06% | Val Top5: 49.42%
[2026-01-30 12:12:08,544][cifar10_vit_small_pretrained][INFO] -    >>> Best model saved (Top1: 10.06%)
[2026-01-30 12:17:49,371][cifar10_vit_small_pretrained][INFO] - Epoch 5/50 | Train Loss: 2.3055 | Train Top1: 10.25% | Val Top1: 9.76% | Val Top5: 49.78%
[2026-01-30 12:23:32,016][cifar10_vit_small_pretrained][INFO] - Epoch 6/50 | Train Loss: 2.2014 | Train Top1: 15.21% | Val Top1: 22.88% | Val Top5: 76.10%
[2026-01-30 12:23:32,714][cifar10_vit_small_pretrained][INFO] -    >>> Best model saved (Top1: 22.88%)
[2026-01-30 12:29:14,577][cifar10_vit_small_pretrained][INFO] - Epoch 7/50 | Train Loss: 2.0318 | Train Top1: 23.07% | Val Top1: 24.36% | Val Top5: 79.96%
[2026-01-30 12:29:15,293][cifar10_vit_small_pretrained][INFO] -    >>> Best model saved (Top1: 24.36%)
[2026-01-30 12:34:56,941][cifar10_vit_small_pretrained][INFO] - Epoch 8/50 | Train Loss: 1.8452 | Train Top1: 29.74% | Val Top1: 31.54% | Val Top5: 84.88%
[2026-01-30 12:34:57,527][cifar10_vit_small_pretrained][INFO] -    >>> Best model saved (Top1: 31.54%)
[2026-01-30 12:40:40,354][cifar10_vit_small_pretrained][INFO] - Epoch 9/50 | Train Loss: 1.7325 | Train Top1: 34.63% | Val Top1: 32.12% | Val Top5: 82.42%
[2026-01-30 12:40:40,894][cifar10_vit_small_pretrained][INFO] -    >>> Best model saved (Top1: 32.12%)
[2026-01-30 12:46:23,930][cifar10_vit_small_pretrained][INFO] - Epoch 10/50 | Train Loss: 1.6600 | Train Top1: 38.09% | Val Top1: 41.58% | Val Top5: 88.80%
[2026-01-30 12:46:24,452][cifar10_vit_small_pretrained][INFO] -    >>> Best model saved (Top1: 41.58%)
[2026-01-30 12:52:06,377][cifar10_vit_small_pretrained][INFO] - Epoch 11/50 | Train Loss: 1.6116 | Train Top1: 40.46% | Val Top1: 40.44% | Val Top5: 90.54%
[2026-01-30 12:57:49,394][cifar10_vit_small_pretrained][INFO] - Epoch 12/50 | Train Loss: 1.5873 | Train Top1: 41.28% | Val Top1: 41.22% | Val Top5: 90.28%
[2026-01-30 13:03:33,168][cifar10_vit_small_pretrained][INFO] - Epoch 13/50 | Train Loss: 1.5655 | Train Top1: 42.43% | Val Top1: 43.78% | Val Top5: 91.58%
[2026-01-30 13:03:33,816][cifar10_vit_small_pretrained][INFO] -    >>> Best model saved (Top1: 43.78%)
[2026-01-30 13:09:17,040][cifar10_vit_small_pretrained][INFO] - Epoch 14/50 | Train Loss: 1.5345 | Train Top1: 43.68% | Val Top1: 46.00% | Val Top5: 91.42%
[2026-01-30 13:09:17,845][cifar10_vit_small_pretrained][INFO] -    >>> Best model saved (Top1: 46.00%)
[2026-01-30 13:15:01,052][cifar10_vit_small_pretrained][INFO] - Epoch 15/50 | Train Loss: 1.5116 | Train Top1: 44.63% | Val Top1: 44.56% | Val Top5: 90.30%
[2026-01-30 13:20:42,896][cifar10_vit_small_pretrained][INFO] - Epoch 16/50 | Train Loss: 1.4849 | Train Top1: 45.76% | Val Top1: 47.56% | Val Top5: 92.74%
[2026-01-30 13:20:43,615][cifar10_vit_small_pretrained][INFO] -    >>> Best model saved (Top1: 47.56%)
[2026-01-30 13:26:59,898][cifar10_vit_small_pretrained][INFO] - Epoch 17/50 | Train Loss: 1.4669 | Train Top1: 46.53% | Val Top1: 47.76% | Val Top5: 91.90%
[2026-01-30 13:27:00,560][cifar10_vit_small_pretrained][INFO] -    >>> Best model saved (Top1: 47.76%)
[2026-01-30 13:32:57,089][cifar10_vit_small_pretrained][INFO] - Epoch 18/50 | Train Loss: 1.4490 | Train Top1: 47.19% | Val Top1: 46.26% | Val Top5: 91.72%
[2026-01-30 13:38:36,853][cifar10_vit_small_pretrained][INFO] - Epoch 19/50 | Train Loss: 1.4289 | Train Top1: 48.34% | Val Top1: 49.30% | Val Top5: 93.14%
[2026-01-30 13:38:37,570][cifar10_vit_small_pretrained][INFO] -    >>> Best model saved (Top1: 49.30%)
[2026-01-30 13:43:34,464][cifar10_vit_small_pretrained][INFO] - Epoch 20/50 | Train Loss: 1.4231 | Train Top1: 48.63% | Val Top1: 44.26% | Val Top5: 91.64%
[2026-01-30 13:48:32,177][cifar10_vit_small_pretrained][INFO] - Epoch 21/50 | Train Loss: 1.4219 | Train Top1: 48.07% | Val Top1: 50.42% | Val Top5: 93.92%
[2026-01-30 13:48:32,769][cifar10_vit_small_pretrained][INFO] -    >>> Best model saved (Top1: 50.42%)
[2026-01-30 13:53:46,321][cifar10_vit_small_pretrained][INFO] - Epoch 22/50 | Train Loss: 1.4011 | Train Top1: 49.23% | Val Top1: 48.30% | Val Top5: 92.64%
